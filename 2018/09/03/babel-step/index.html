<!DOCTYPE html><html lang="zh-cn"><head><meta charset="utf-8"><meta name="X-UA-Compatible" content="IE=edge"><title> babel 的使用 · Olier</title><meta name="description" content="babel 的使用 - TbhT"><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="icon" href="/favicon.png"><link rel="stylesheet" href="/css/hermes.css"><link rel="search" type="application/opensearchdescription+xml" href="http://olierjs.github.io/atom.xml" title="Olier"><meta name="generator" content="Hexo 5.4.0"><link rel="alternate" href="/atom.xml" title="Olier" type="application/atom+xml">
</head><body><div class="wrap"><header><a class="logo-link" href="/"><img src="/favicon.png" alt="logo"></a><ul class="nav nav-list"><li class="nav-list-item"><a class="nav-list-link" href="/" target="_self">BLOG</a></li><li class="nav-list-item"><a class="nav-list-link" href="https://github.com/olierjs" target="_blank">GITHUB</a></li><li class="nav-list-item"><a class="nav-list-link" href="/archives/" target="_self">ARCHIVE</a></li><li class="nav-list-item"><a class="nav-list-link" href="/atom.xml" target="_self">FEED</a></li></ul></header><main class="container"><div class="post"><article class="post-block"><h1 class="post-title">babel 的使用</h1><div class="post-info">2018年9月3日</div><div class="post-content"><h2 id="babel-配置的坑"><a href="#babel-配置的坑" class="headerlink" title="babel 配置的坑"></a>babel 配置的坑</h2><blockquote>
<p>.babelrc</p>
</blockquote>
<h3 id="Plugin-Preset-的简写"><a href="#Plugin-Preset-的简写" class="headerlink" title="Plugin/Preset 的简写"></a>Plugin/Preset 的简写</h3><p>  如果插件的前缀是以 <code>babel-plugin-</code> 前缀开头的，那么在 <code>plugins</code> 的配置中可以简写，例如：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// plugins 和 presets 类似</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="string">&quot;plugins&quot;</span>: [<span class="string">&quot;myPlugin&quot;</span>]</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 下面与上面的功能一致</span></span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line">    <span class="string">&quot;plugins&quot;</span>: [<span class="string">&quot;babel-plugin-myPlugin&quot;</span>]</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// 缩写 在特定领域的包中也是适用的</span></span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line">    <span class="string">&quot;presets&quot;</span>: [<span class="string">&quot;@org/babel-preset-myPreset&quot;</span>]</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 下面与上面一致</span></span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line">    <span class="string">&quot;presets&quot;</span>: [<span class="string">&quot;@org/myPreset&quot;</span>]</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>


<h3 id="Plugin-Preset-插件的顺序"><a href="#Plugin-Preset-插件的顺序" class="headerlink" title="Plugin/Preset  插件的顺序"></a>Plugin/Preset  插件的顺序</h3><p>  插件的顺序还是蛮重要的，对于一个 <code>js</code> 文件来说，如果有两个插件使用转换这个文件，那么这些转换器<br>将以下面的顺序进行转换：</p>
<ul>
<li><p>插件 <code>Plugin</code> 运行在 插件集<code>Preset</code> 之前</p>
</li>
<li><p>插件 <code>Plugin</code>中的顺序是从 <code>0-n</code>， 也就是从第一个到最后一个</p>
</li>
<li><p>插件集 <code>Preset</code> 中的顺序则是从 <code>n-0</code>， 也就是从最后一个到第一个</p>
<p>例如：</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="attr">&quot;plugins&quot;</span>: [</span><br><span class="line">        <span class="string">&quot;transform-decorators-legacy&quot;</span>,</span><br><span class="line">        <span class="string">&quot;transform-class-properties&quot;</span></span><br><span class="line">    ]</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>上面的配置将会先运行 <code>transform-decorators-legacy</code>， 再运行 <code>transform-class-properties</code>.</p>
</li>
</ul>
<p> <code>presets</code> 的顺序是反过来的，这一点是很重要的: </p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="attr">&quot;presets&quot;</span>: [</span><br><span class="line">        <span class="string">&quot;es2015&quot;</span>,</span><br><span class="line">        <span class="string">&quot;react&quot;</span>,</span><br><span class="line">        <span class="string">&quot;stage-2&quot;</span></span><br><span class="line">    ]</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>上面配置的运行顺序是： <code>stage-2</code>, <code>react</code>, <code>es2015</code>.</p>
<h3 id="Plugin-Preset-选项"><a href="#Plugin-Preset-选项" class="headerlink" title="Plugin/Preset 选项"></a>Plugin/Preset 选项</h3><p> <code>plugins</code>和<code>presets</code>都有可选项，这些可选项都是以一个数组包起来的，数组中以 <code>name, object</code>为元素，例如：</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="attr">&quot;plugins&quot;</span>: [</span><br><span class="line">        [</span><br><span class="line">            <span class="string">&quot;transform-async-to-module-method&quot;</span>, </span><br><span class="line">            &#123;</span><br><span class="line">                <span class="attr">&quot;module&quot;</span>: <span class="string">&quot;bluebird&quot;</span>,</span><br><span class="line">                <span class="attr">&quot;method&quot;</span>: <span class="string">&quot;coroutine&quot;</span></span><br><span class="line">            &#125;</span><br><span class="line">        ]</span><br><span class="line">    ]</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><code>presets</code>的设置也一样：</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="attr">&quot;presets&quot;</span>: [</span><br><span class="line">        [</span><br><span class="line">            <span class="string">&quot;es2015&quot;</span>: &#123;</span><br><span class="line">                <span class="attr">&quot;loose&quot;</span>: <span class="literal">true</span>,</span><br><span class="line">                <span class="attr">&quot;modules&quot;</span>: <span class="literal">false</span></span><br><span class="line">            &#125;</span><br><span class="line">        ]</span><br><span class="line">    ]</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>


<h3 id="babel-polyfill"><a href="#babel-polyfill" class="headerlink" title="babel-polyfill"></a>babel-polyfill</h3><p>  <a target="_blank" rel="noopener" href="https://en.wikipedia.org/wiki/Polyfill_(programming)">ployfill</a>， 如果不添加 <code>babel-polyfill</code> ，那么直接由 <code>babel-preset-env</code><br>生成的 <code>es5</code> 代码在某些浏览器或者 <code>webview</code> 里面是不支持所有的 <code>es5</code> 特性的，所以要想让他们这些环境支持，就需要使用<code>polyfill</code>进行补充。</p>
<p>  <code>ployfill</code> 可以在一些不支持新特性的浏览器中，在全局补充这些方法。从而使得新的特性的代码能够运行在一些不支持新特性的代码中。如果要支持到<code>es3</code>，那么<br>可以在全局引入一些<code>shim</code>库，比如<a target="_blank" rel="noopener" href="https://github.com/es-shims/es5-shim">es5-shim</a>。</p>
<p>  在使用 <code>ployfill</code> 库的时候，需要将它作为 <code>dependency</code>，因为它是运行在我们自己的代码之前的，并且要放到生产环境下的。</p>
</div></article></div></main><footer><div class="paginator"><a class="prev" href="/2018/11/30/nginx-step/">上一篇</a></div><div class="copyright"><p>© 2019 - 2022 <a href="http://olierjs.github.io">TbhT</a>, powered by <a href="https://hexo.io/" target="_blank">Hexo</a> and <a href="https://github.com/claymcleod/hexo-theme-hermes" target="_blank">hexo-theme-hermes</a>. </p><p>Logo made by <a target="_blank" rel="noopener" href="https://www.flaticon.com/authors/freepik">Freepik</a> from <a target="_blank" rel="noopener" href="https://flaticon.com">www.flaticon.com</a>.</p></div></footer></div><script async src="//cdn.bootcss.com/mathjax/2.7.0/MathJax.js?config=TeX-MML-AM_CHTML" integrity="sha384-crwIf/BuaWM9rM65iM+dWFldgQ1Un8jWZMuh3puxb8TOY9+linwLoI7ZHZT+aekW" crossorigin="anonymous"></script><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=GTM-5K584LS"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'GTM-5K584LS');</script></body></html>